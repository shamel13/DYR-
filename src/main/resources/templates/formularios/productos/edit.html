<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Editar Producto</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<div class="max-w-4xl mx-auto py-10 px-4">
  <!-- Botón volver -->
  <div class="mb-6">
    <a th:href="@{/productos}" 
       class="inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600 transition">
      ← Volver al listado
    </a>
  </div>

  <h1 class="text-3xl font-bold text-blue-600 mb-6">Editar Producto</h1>

  <!-- Errores -->
  <div th:if="${success}" class="mb-4 p-3 bg-green-100 text-green-700 rounded">
    <strong>✅ Producto actualizado</strong>
  </div>

  <!-- Vista previa de imagen actual -->
  <div class="mb-6 bg-white p-4 rounded shadow">
    <p class="text-sm font-medium text-gray-700 mb-2">Imagen actual:</p>
    <img th:src="${producto.imagenUrl != null && producto.imagenUrl != '' ? producto.imagenUrl : 'https://placehold.co/400x400?text=Sin+imagen'}" th:alt="${producto.nombre}" class="max-h-48 object-cover rounded" onerror="this.src='https://placehold.co/400x400?text=Sin+imagen'">
  </div>

    <form th:action="@{/productos/{id}(id=${producto.id})}" method="post" enctype="multipart/form-data"
      class="grid md:grid-cols-2 gap-6 bg-white p-6 rounded shadow">

    <div>
      <label class="block text-sm font-medium">Nombre</label>
      <input type="text" name="nombre" th:value="${producto.nombre}" class="input-field" required>
    </div>

    <div>
      <label class="block text-sm font-medium">Precio</label>
      <input type="number" step="0.01" name="precio" th:value="${producto.precio}" class="input-field" required>
    </div>

    <div class="md:col-span-2">
      <label class="block text-sm font-medium">Descripción</label>
      <textarea name="descripcion" rows="3" class="input-field" th:text="${producto.descripcion}"></textarea>
    </div>

    <div class="md:col-span-2">
      <label class="block text-sm font-medium">Sube una nueva imagen (reemplazará la actual)</label>
      <input type="file" name="imagen" accept="image/*" class="input-field">
      <p class="text-xs text-gray-500 mt-1">Dejar en blanco para mantener la imagen actual</p>
    </div>

    <div class="md:col-span-2 flex justify-end gap-2">
      <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded">Actualizar</button>
      <a th:href="@{/productos/{id}(id=${producto.id})}" class="px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 inline-block">
        Ver detalle
      </a>
    </div>
  </form>

  <div class="mt-4 text-right">
    <form th:action="@{/productos/{id}/delete(id=${producto.id})}" method="post" class="inline" onsubmit="return confirm('¿Eliminar producto?');">
      <button type="submit" class="px-6 py-2 bg-red-500 text-white rounded hover:bg-red-600">
        Eliminar
      </button>
    </form>
  </div>
</div>

<style>
  .input-field {
    margin-top: 0.25rem;
    width: 100%;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    padding: 0.5rem 1rem;
    outline: none;
  }
  .input-field:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
  }
</style>
</body>
</html>
