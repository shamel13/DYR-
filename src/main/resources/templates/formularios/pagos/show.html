<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Detalle del Pago</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body class="bg-gray-100 p-6">

<div class="mb-6">
  <a th:href="@{/pagos}" class="inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg shadow hover:bg-gray-600 transition">
    ‚Üê Volver a Pagos
  </a>
</div>

<div class="max-w-4xl mx-auto">
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex justify-between items-start mb-6">
      <div>
        <h1 class="text-2xl font-bold mb-2">Detalle del Pago</h1>
        <p class="text-gray-600">Referencia: <span class="font-mono font-bold" th:text="${pago.numeroReferencia}"></span></p>
      </div>
      <div>
        <span th:if="${pago.estado == 'Pendiente'}" class="px-3 py-2 bg-yellow-100 text-yellow-700 rounded-lg">‚è≥ Pendiente</span>
        <span th:if="${pago.estado == 'Procesando'}" class="px-3 py-2 bg-blue-100 text-blue-700 rounded-lg">üîÑ Procesando</span>
        <span th:if="${pago.estado == 'Completado'}" class="px-3 py-2 bg-green-100 text-green-700 rounded-lg">‚úì Completado</span>
        <span th:if="${pago.estado == 'Fallido'}" class="px-3 py-2 bg-red-100 text-red-700 rounded-lg">‚úó Fallido</span>
        <span th:if="${pago.estado == 'Reembolsado'}" class="px-3 py-2 bg-purple-100 text-purple-700 rounded-lg">‚Ü© Reembolsado</span>
      </div>
    </div>

    <!-- Monto -->
    <div class="bg-blue-50 p-6 rounded-lg mb-6 text-center">
      <div class="text-sm text-gray-600 mb-2">Monto del Pago</div>
      <div class="text-4xl font-bold text-blue-600" th:text="'$' + ${#numbers.formatDecimal(pago.monto,1,'COMMA',2,'POINT')}"></div>
    </div>

    <!-- Informaci√≥n General -->
    <div class="mb-6">
      <h2 class="text-lg font-bold mb-4 pb-2 border-b">Informaci√≥n General</h2>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="text-sm text-gray-600">Usuario</label>
          <div class="font-medium" th:text="${pago.usuario != null ? pago.usuario.name : 'N/A'}"></div>
        </div>
        <div>
          <label class="text-sm text-gray-600">Email</label>
          <div class="font-medium" th:text="${pago.usuario != null ? pago.usuario.email : 'N/A'}"></div>
        </div>
        <div>
          <label class="text-sm text-gray-600">M√©todo de Pago</label>
          <div class="font-medium flex items-center gap-2">
            <i th:if="${pago.metodoPago == 'Tarjeta'}" class="fas fa-credit-card text-blue-600"></i>
            <i th:if="${pago.metodoPago == 'PayPal'}" class="fab fa-paypal text-blue-500"></i>
            <i th:if="${pago.metodoPago == 'Transferencia'}" class="fas fa-university text-green-600"></i>
            <i th:if="${pago.metodoPago == 'Efectivo'}" class="fas fa-money-bill text-green-700"></i>
            <span th:text="${pago.metodoPago}"></span>
          </div>
        </div>
        <div>
          <label class="text-sm text-gray-600">Fecha de Pago</label>
          <div class="font-medium" th:text="${#temporals.format(pago.fechaPago, 'dd/MM/yyyy HH:mm:ss')}"></div>
        </div>
        <div th:if="${pago.fechaActualizacion != null}" class="col-span-2">
          <label class="text-sm text-gray-600">√öltima Actualizaci√≥n</label>
          <div class="font-medium" th:text="${#temporals.format(pago.fechaActualizacion, 'dd/MM/yyyy HH:mm:ss')}"></div>
        </div>
      </div>
    </div>

    <!-- Detalles del M√©todo de Pago -->
    <div class="mb-6" th:if="${pago.metodoPago != 'Efectivo'}">
      <h2 class="text-lg font-bold mb-4 pb-2 border-b">Detalles del M√©todo de Pago</h2>
      
      <!-- Tarjeta -->
      <div th:if="${pago.metodoPago == 'Tarjeta'}" class="bg-blue-50 p-4 rounded-lg">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-gray-600">N√∫mero de Tarjeta</label>
            <div class="font-mono font-bold" th:text="${pago.numeroTarjeta}"></div>
          </div>
          <div>
            <label class="text-sm text-gray-600">Tipo</label>
            <div class="font-medium" th:text="${pago.tipoTarjeta}"></div>
          </div>
          <div class="col-span-2">
            <label class="text-sm text-gray-600">Titular</label>
            <div class="font-medium" th:text="${pago.nombreTitular}"></div>
          </div>
        </div>
      </div>

      <!-- PayPal -->
      <div th:if="${pago.metodoPago == 'PayPal'}" class="bg-blue-50 p-4 rounded-lg">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-gray-600">Email de PayPal</label>
            <div class="font-medium" th:text="${pago.emailPaypal}"></div>
          </div>
          <div>
            <label class="text-sm text-gray-600">Transaction ID</label>
            <div class="font-mono text-xs" th:text="${pago.transactionIdPaypal}"></div>
          </div>
        </div>
      </div>

      <!-- Transferencia -->
      <div th:if="${pago.metodoPago == 'Transferencia'}" class="bg-green-50 p-4 rounded-lg">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-gray-600">Banco / Cuenta</label>
            <div class="font-medium" th:text="${pago.bancoCuenta}"></div>
          </div>
          <div>
            <label class="text-sm text-gray-600">N√∫mero de Transferencia</label>
            <div class="font-medium" th:text="${pago.numeroTransferencia}"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Descripci√≥n -->
    <div th:if="${pago.descripcion != null && !pago.descripcion.isEmpty()}" class="mb-6">
      <h2 class="text-lg font-bold mb-4 pb-2 border-b">Descripci√≥n</h2>
      <p class="text-gray-700" th:text="${pago.descripcion}"></p>
    </div>

    <!-- Acciones -->
    <div class="flex gap-3 justify-end pt-4 border-t">
      <form th:if="${pago.estado == 'Pendiente'}" th:action="@{/pagos/{id}/procesar(id=${pago.id})}" method="post" class="inline">
        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center gap-2">
          <i class="fas fa-check-circle"></i> Procesar Pago
        </button>
      </form>
      <form th:if="${pago.estado == 'Completado'}" th:action="@{/pagos/{id}/reembolsar(id=${pago.id})}" method="post" class="inline" onsubmit="return confirm('¬øEst√° seguro de reembolsar este pago?');">
        <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2">
          <i class="fas fa-undo"></i> Reembolsar
        </button>
      </form>
      <form th:action="@{/pagos/{id}/delete(id=${pago.id})}" method="post" class="inline" onsubmit="return confirm('¬øEliminar este pago permanentemente?');">
        <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 flex items-center gap-2">
          <i class="fas fa-trash"></i> Eliminar
        </button>
      </form>
    </div>
  </div>
</div>

</body>
</html>
