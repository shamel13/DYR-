<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Editar Venta</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<div class="max-w-4xl mx-auto py-10 px-4">
  <div class="mb-6">
    <a th:href="@{/ventas}" 
       class="inline-flex items-center px-4 py-2 bg-red-500 text-white rounded-lg shadow hover:bg-red-600 transition">
      ← Volver al listado
    </a>
  </div>

  <h1 class="text-3xl font-bold text-red-600 mb-6">Editar Venta</h1>

  <div th:if="${success}" class="mb-4 p-3 bg-green-100 text-green-700 rounded">
    <strong>✅ Venta actualizada</strong>
  </div>

  <form th:action="@{/ventas/{id}(id=${venta.id})}" method="post"
        class="grid md:grid-cols-2 gap-6 bg-white p-6 rounded shadow">

    <div>
      <label class="block text-sm font-medium">Cliente</label>
      <select name="clienteId" class="input-field" required>
        <option th:each="c : ${clientes}" th:value="${c.id}" th:text="${c.nombre}"
                th:selected="${venta.cliente.id == c.id}"></option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium">Vendedor</label>
      <select name="userId" class="input-field" required>
        <option th:each="u : ${users}" th:value="${u.id}" th:text="${u.name}"
                th:selected="${venta.user.id == u.id}"></option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium">Producto</label>
      <select name="productoId" class="input-field" required>
        <option th:each="p : ${productos}" th:value="${p.id}" th:text="${p.nombre}"
                th:selected="${venta.producto.id == p.id}"></option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium">Cantidad</label>
      <input type="number" name="cantidad" min="1" th:value="${venta.cantidad}" class="input-field" required>
    </div>

    <div class="md:col-span-2">
      <label class="block text-sm font-medium">Fecha de venta</label>
      <input type="date" name="fechaVenta" th:value="${#temporals.format(venta.fechaVenta,'yyyy-MM-dd')}" class="input-field">
    </div>

    <div class="md:col-span-2 text-right space-x-2">
      <button type="submit" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded">Actualizar</button>
      <a th:href="@{/ventas/{id}(id=${venta.id})}" class="px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 inline-block">
        Ver detalle
      </a>
      <form th:action="@{/ventas/{id}/delete(id=${venta.id})}" method="post" class="inline" onsubmit="return confirm('¿Eliminar venta?');">
        <button type="submit" class="px-6 py-2 bg-red-500 text-white rounded hover:bg-red-600">
          Eliminar
        </button>
      </form>
    </div>
  </form>
</div>

<style>
  .input-field { margin-top:0.25rem; width:100%; border:1px solid #d1d5db; border-radius:0.5rem; padding:0.5rem 1rem; outline:none; }
  .input-field:focus { border-color:#ef4444; box-shadow:0 0 0 2px rgba(239,68,68,0.3); }
</style>
</body>
</html>
